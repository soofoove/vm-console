<div class="table-ios">
  <div class="table-responsive">
    <table class="table align-middle">
      <thead>
        <tr>
          <th style="width:44px;">
            <input
              type="checkbox"
              class="form-check-input"
              [checked]="(isAllVisibleSelected$ | async) ?? false"
              *ngIf="pagedVms$ | async as page"
              (change)="toggleSelectAll(page.items)"
            />
          </th>
          <th>Имя</th>
          <th>Статус</th>
          <th>IP / DNS</th>
          <th>Конфиг</th>
          <th>TTL</th>
          <th>Удаление</th>
          <th class="text-end">Действия</th>
        </tr>
      </thead>
      <tbody *ngIf="pagedVms$ | async as page">
        <tr *ngFor="let vm of page.items">
          <td>
            <input
              type="checkbox"
              class="form-check-input"
              [checked]="(selectedIds$ | async)?.has(vm.id)"
              (change)="toggleSelect(vm, $any($event.target).checked)"
            />
          </td>
          <td class="clickable" (click)="openDetails(vm)">
            <div class="fw-semibold">{{ vm.name }}</div>
            <div class="small text-muted-2">tags: {{ vm.tags.join(', ') }}</div>
          </td>
          <td>
            <span class="status" [ngClass]="statusMeta(vm.status).className">
              <span class="dot"></span>{{ statusMeta(vm.status).label }}
            </span>
          </td>
          <td>
            <div class="fw-semibold mono">{{ vm.ip || '—' }}</div>
            <div class="small text-muted-2 mono">{{ vm.dns }}</div>
          </td>
          <td>
            <span class="badge-soft">{{ vm.cpu }} vCPU</span>
            <span class="badge-soft">{{ vm.ram }} GB</span>
            <span class="badge-soft">{{ vm.disk }} GB</span>
          </td>
          <td>
            <div class="small text-muted-2">осталось</div>
            <div class="fw-semibold">
              <span
                [style.color]="ttlLabel(vm).kind === 'danger' ? 'var(--red)' : ttlLabel(vm).kind === 'warn' ? 'var(--orange)' : ''"
                style="font-weight: 900;"
              >
                {{ ttlLabel(vm).label }}
              </span>
            </div>
          </td>
          <td>
            <div class="small text-muted-2">авто-удаление</div>
            <div class="fw-semibold">{{ formatDate(vm.deleteAt) }}</div>
          </td>
          <td class="text-end">
            <app-vm-row-actions [vm]="vm"></app-vm-row-actions>
          </td>
        </tr>
        <tr *ngIf="page.items.length === 0">
          <td colspan="8" class="text-muted-2">Нет данных.</td>
        </tr>
      </tbody>
    </table>
  </div>
</div>
